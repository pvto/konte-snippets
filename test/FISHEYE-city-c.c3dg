DEF BLOCKS 20

//fov { ZPOW 4.5 rx 15 ry -10 y .8 x -.2}
fov{FISHEYE .4 0 .1 1.2 rx 4 ry 10 y .4 x -.2}
all {
  city { z .1}
}



rule city {
  *{B .1 L .3 S -.8 y -1}
  *{z 1 y -.1 layer -300}
    200*{y .01 L .002 S -.003}
      SQUARE{ sx 3 sy .015}
  *{x -.75 z -.45}
  (BLOCKS*1.25)*{x 1/BLOCKS layer -1}
    (BLOCKS*1.25)*{z 1/BLOCKS layer -1}
    {
      create_building{rx 90 scale 1/BLOCKS}
//      SQUARE{layer -2 rx 90 z -.5/BLOCKS scale 1.2/BLOCKS 
//        A -.9}
    }
}
create_building 3{create_building{col0 (col0+.1)}}
create_building {building{shading shd sx .5 sy .5 sz .8 s 1+rndf()*.4}}
building {
  block{}
  building_{z 1 layer .1}
}
building_ .4 {
  2*{x .5} 2*{y .5}
  building { s .5 x -.5 y -.5 z -.5}
}
building_ 1{}
building_ 1{building{}}

block 1.3{block{sx .5}}
block {
  BOX{s .8 shading -1 y .1 A -.9}
  5*{s .75 rz 1} 
  cub{PUSH frame {BO=0.465}}
}


cub{
  PEEK{z -.5}
  PEEK{z .5 ry 180}
  PEEK{x -.5 ry -90}
  PEEK{x .5 ry 90}
  PEEK{y -.5 rx 90}
  PEEK{y .5 rx -90}
}


shading shd {
    point(0.0) { A 1        RGB 0.9 0.9 0.8 }
    point(.25) { A 1        RGB 0.218 0.218 .218 }
    point(.5)  { A 1        RGB 0.6 0.6 0.6 }
    point(.75) { A 1        RGB 0.7 0.7 0.7 }
    point(1.0) { A 1        RGB 0.1 0.1 .15 }
}

light {AMBIENT s .25}
light {PHONG specular 10 alpha 10 s 3.5 {RGB 1 1 1}
  point(
    0,1,-2
  )
}


//DEF BO 0.48

path frame {
    moveto(-.5,-.5,.0)
    lineto(-.5,.5,.0)
    lineto(.5,.5,.0)
    lineto(.5,-.5,.0)
    lineto(-.5,-.5,.0)
    close
    moveto(-BO,-BO,.0)
    lineto(BO,-BO,.0)
    lineto(BO,BO,.0)
    lineto(-BO,BO,.0)
    lineto(-BO,-BO,.0)
    close
}
